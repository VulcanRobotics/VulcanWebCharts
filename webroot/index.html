<!doctype html>
<html>

<head>
    <title>Line Chart</title>
    <script src="Chart.js"></script>
    <style>
    canvas{
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
    </style>
</head>

<body>
    <div style="width:75%;">
        <canvas id="canvas"></canvas>
    </div>

    <script>
    var red = "#FF0000"
    var green = "#00FF00"
    var blue = "#0000FF"

    console.log("Fetching TalonSRX1.json");
    fetch("/log/talonSRX/TalonSRX1.json",{cache: "no-store"}).then(function(response){
      return response.json()
    }).then(function(data){
      console.log("Sucessfuly fetched TalonSRX1.json, generating chart.");
      var count = data.setpoint.length;
      var xAxisLabels = [];
      var setpoints = [];
      var velocitys = [];
      var errors = [];

      for (i = 0; i <= count; i++){
        xAxisLabels.push(i*20);
        setpoints.push({x:data.timeStamp[i],y:data.setpoint[i]});
        velocitys.push({x:data.timeStamp[i],y:data.velocity[i]});
        errors.push({x:data.timeStamp[i],y:data.error[i]});
      }
      var config = {
          type: 'line',
          data: {
              labels: xAxisLabels,
              datasets: [{
                  label: "Setpoint",
                  backgroundColor: red,
                  borderColor: red,
                  data: setpoints,
                  fill: false,
              }, {
                  label: "Velocity",
                  fill: false,
                  backgroundColor: blue,
                  borderColor: blue,
                  data: velocitys,
              }, {
                  label: "Error",
                  fill: false,
                  backgroundColor: green,
                  borderColor: green,
                  data: errors,
              }]
          },
          options: {
              responsive: true,
              title:{
                  display:true,
                  text:'TalonSRX1'
              },
              tooltips: {
                  mode: 'index',
                  intersect: false,
              },
              hover: {
                  mode: 'nearest',
                  intersect: true
              },
              scales: {
                  xAxes: [{
                      display: true,
                      scaleLabel: {
                          display: true,
                          labelString: 'milliseconds'
                      }
                  }],
                  yAxes: [{
                      display: true,
                      scaleLabel: {
                          display: true,
                          labelString: 'encoder counts per 100 milliseconds'
                      }
                  }]
              }
          }
      };

      var ctx = document.getElementById("canvas").getContext("2d");
      myLine = new Chart(ctx, config);
      console.log("done");
    });
    </script>
<!-- <p>xAxisLegend</p> -->
</body>

</html>
